<!DOCTYPE html>
<html>
<head>
<meta charset="EUC-KR">
<title>Insert title here</title>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type="text/javascript" src="../js/my.js"></script>

 
<style type="text/css">
.wrap {
	width: 800px;
	height: 420px;
	border: 1px solid #000;
}

.divleftImg {
	width: 50%;
	float: left;
	box-sizing: border-box;
	
}

.divRightImg {
	width: 50%;
	float: right;
	box-sizing: border-box;
	
}
</style>
<script type="text/javascript">
$(document).ready(function(){
	console.log(localStorage.getItem('result')); 
	var resultData=JSON.parse(localStorage.getItem('result'));
	resultData = JSON.parse(resultData);
	console.log(resultData);
	//console.log(data.info.size.width)
	if (resultData.info.faceCount == 1) {
		$("#drawCanvas2").attr('width', resultData.info.size.width + 'px');
		$("#drawCanvas2").attr('height', resultData.info.size.height + 'px');
		$("#drawCanvas2").attr('style', "border: 1px solid #993300");
		const canvas = document.getElementById("drawCanvas2");
		const context = canvas.getContext("2d");
		const image = new Image();

		image.src = '../media/test.png';

		image.onload = function() {
			context.drawImage(image, 0, 0);
		}

		var jsonArray = new Array();
		if (resultData.info.faceCount > 0) {
			let faces = resultData.info.faceCount;
			for (let i = 0; i < faces; i++) {
				var jsonObj = new Object();
				jsonObj.celebrity = resultData.faces[i].celebrity.value;
				jsonObj.confidence = (resultData.faces[i].celebrity.confidence) * 100 + "%";

				jsonObj = JSON.stringify(jsonObj);
				//String 형태로 파싱한 객체를 다시 json으로 변환
				jsonArray.push(JSON.parse(jsonObj));
			}
			console.log(jsonArray);
			for (let i = 0; i < jsonArray.length; i++) {
				var result = jsonArray[i].celebrity + "을(를) " + jsonArray[i].confidence + "정도 닮았습니다.<br>";
				console.log(result);
				$("#resultDiv1").append(result);
			}
			var celebrity = resultData.faces[0].celebrity.value;
			//console.log(celebrity);
			$.post('../celeImg', { celebrity }, function() {
				$("#celeImg1").attr("src","../media/newCele.png");
			});

		} else {
			$("#resultDiv1").text("닮은꼴 연예인이 없네요 ㅠㅠ");
		}
	}else if(resultData.info.faceCount>1){
		alert("얼굴이 2개이상 검출되었습니다 한개의 얼굴만 들어간 사진을 넣어주세요~");
	}else{
		alert("얼굴이 검출되지 않았습니다 사진을 다시한번 확인해 주세요");
	}
});
</script>
</head>
<body>
	<div id="resultDiv1"></div>
	<div class="wrap">
		<div class="divleftImg">
			<canvas id="drawCanvas2"></canvas>
		</div>
		<div class="divRightImg">
			<img id="celeImg1" src="" alt="">
		</div>
	</div>
</body>
</html>